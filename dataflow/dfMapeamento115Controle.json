{
	"name": "dfMapeamento115Controle",
	"properties": {
		"folder": {
			"name": "Conv115"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Arq_Conv115_Controle",
						"type": "DatasetReference"
					},
					"name": "EntradaControleV3"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "Arq_Conv115_Controle_parquet",
						"type": "DatasetReference"
					},
					"name": "SaidaParquetArqControle"
				}
			],
			"transformations": [
				{
					"name": "ColunasDerivadas"
				}
			],
			"scriptLines": [
				"parameters{",
				"     pNomeArq as string",
				"}",
				"source(output(",
				"          ControleV3 as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     moveFiles: ['','originais']) ~> EntradaControleV3",
				"EntradaControleV3 derive(Cnpj = trim(substring(ControleV3, 1, 18)),",
				"          IE = trim(substring(ControleV3, 19, 15)),",
				"          RazaoSocial = trim(substring(ControleV3, 34, 50)),",
				"          Endereco = trim(substring(ControleV3, 84, 50)),",
				"          CEP = trim(substring(ControleV3, 134, 9)),",
				"          Bairro = trim(substring(ControleV3, 143, 30)),",
				"          Municipio = trim(substring(ControleV3, 173, 30)),",
				"          UF = trim(substring(ControleV3, 203, 2)),",
				"          Responsavel = trim(substring(ControleV3, 205, 30)),",
				"          Cargo = trim(substring(ControleV3, 235, 20)),",
				"          Telefone = trim(substring(ControleV3, 255, 12)),",
				"          Email = trim(substring(ControleV3, 267, 40)),",
				"          QtdeRegMestre = trim(substring(ControleV3, 307, 7)),",
				"          QtdeNFcanceladas = trim(substring(ControleV3, 314, 7)),",
				"          DataEmissaoPriDoc = trim(substring(ControleV3, 321, 8)),",
				"          DataEmissaoUltDoc = trim(substring(ControleV3, 329, 8)),",
				"          NumeroPriDoc = trim(substring(ControleV3, 337, 9)),",
				"          NumeroUltDoc = trim(substring(ControleV3, 346, 9)),",
				"          ValorTotal = trim(substring(ControleV3, 355, 14)),",
				"          BCIcms = trim(substring(ControleV3, 369, 14)),",
				"          ICMS = trim(substring(ControleV3, 383, 14)),",
				"          OpIsentas = trim(substring(ControleV3, 397, 14)),",
				"          ValoresNaoBC = trim(substring(ControleV3, 411, 14)),",
				"          NomeArqMestre = trim(substring(ControleV3, 425, 40)),",
				"          StatusRetificacao = trim(substring(ControleV3, 465, 1)),",
				"          CodAutenticacao = trim(substring(ControleV3, 466, 32)),",
				"          QtdeRegItem = trim(substring(ControleV3, 498, 9)),",
				"          QtdeItensCancelados = trim(substring(ControleV3, 507, 7)),",
				"          DataEmissaoPriDocItens = trim(substring(ControleV3, 514, 8)),",
				"          DataEmissaoUltDocItens = trim(substring(ControleV3, 522, 8)),",
				"          NumeroPriDocItens = trim(substring(ControleV3, 530, 9)),",
				"          NumeroUltDocItens = trim(substring(ControleV3, 539, 9)),",
				"          Total = trim(substring(ControleV3, 548, 14)),",
				"          Descontos = trim(substring(ControleV3, 562, 14)),",
				"          Acrescimos = trim(substring(ControleV3, 576, 14)),",
				"          BCIcmsTotal = trim(substring(ControleV3, 590, 14)),",
				"          ICMSTotal = trim(substring(ControleV3, 604, 14)),",
				"          OpIsentasTotal = trim(substring(ControleV3, 618, 14)),",
				"          ValoresNaoBCTotal = trim(substring(ControleV3, 632, 14)),",
				"          NomeArqItem = trim(substring(ControleV3, 646, 40)),",
				"          StatusRetificacaoItem = trim(substring(ControleV3, 686, 1)),",
				"          CodAutenticacaoItem = trim(substring(ControleV3, 687, 32)),",
				"          QtdeCadastroDest = trim(substring(ControleV3, 719, 7)),",
				"          NomeArqCadastro = trim(substring(ControleV3, 726, 40)),",
				"          StatusRetificacaoCadastro = trim(substring(ControleV3, 766, 1)),",
				"          CodAutenticacaoCadastro = trim(substring(ControleV3, 767, 32)),",
				"          VersaoValidador = trim(substring(ControleV3, 799, 3)),",
				"          ChaveReciboEntrega = trim(substring(ControleV3, 802, 6)),",
				"          QtdeAdvertencias = trim(substring(ControleV3, 808, 9)),",
				"          Referencia = trim(substring(ControleV3, 817, 4)),",
				"          Modelo = trim(substring(ControleV3, 821, 2)),",
				"          Serie = trim(substring(ControleV3, 823, 3)),",
				"          Volume = trim(substring(ControleV3, 826, 3)),",
				"          SituacaoVersao = trim(substring(ControleV3, 829, 3)),",
				"          NomeArqCompactado = trim(substring(ControleV3, 832, 60)),",
				"          QtdeTipoA = trim(substring(ControleV3, 892, 9)),",
				"          ValorTotalTipoA = trim(substring(ControleV3, 901, 14)),",
				"          BCIcmsA = trim(substring(ControleV3, 915, 14)),",
				"          ICMSA = trim(substring(ControleV3, 929, 14)),",
				"          IsentasNTA = trim(substring(ControleV3, 943, 14)),",
				"          OutrosValoresA = trim(substring(ControleV3, 957, 14)),",
				"          QtdeTipoB = trim(substring(ControleV3, 971, 9)),",
				"          ValorTotalB = trim(substring(ControleV3, 980, 14)),",
				"          BCIcmsB = trim(substring(ControleV3, 994, 14)),",
				"          ICMSB = trim(substring(ControleV3, 1008, 14)),",
				"          IsentasNTB = trim(substring(ControleV3, 1022, 14)),",
				"          OutrosValoresB = trim(substring(ControleV3, 1036, 14)),",
				"          QtdeTipoC = trim(substring(ControleV3, 1050, 9)),",
				"          ValorTotalC = trim(substring(ControleV3, 1059, 14)),",
				"          BCIcmsC = trim(substring(ControleV3, 1073, 14)),",
				"          ICMSC = trim(substring(ControleV3, 1087, 14)),",
				"          IsentasNTC = trim(substring(ControleV3, 1101, 14)),",
				"          OutrosValoresC = trim(substring(ControleV3, 1115, 14)),",
				"          QtdeTipoD = trim(substring(ControleV3, 1129, 9)),",
				"          ValorTotalD = trim(substring(ControleV3, 1138, 14)),",
				"          BCIcmsD = trim(substring(ControleV3, 1152, 14)),",
				"          ICMSD = trim(substring(ControleV3, 1166, 14)),",
				"          IsentasNTD = trim(substring(ControleV3, 1180, 14)),",
				"          OutrosValoresD = trim(substring(ControleV3, 1194, 14)),",
				"          ChaveControle = trim(substring(ControleV3, 1208, 32)),",
				"          Brancos = trim(substring(ControleV3, 1240, 64)),",
				"          CodAutenticacaoRegistro = trim(substring(ControleV3, 1304, 32)),",
				"          AnoEmissaoPriDoc = trim(substring(ControleV3, 321, 4)),",
				"          MesEmissaoPriDoc = trim(substring(ControleV3, 325, 2)),",
				"          DiaEmissaoPriDoc = trim(substring(ControleV3, 327, 2)),",
				"          UFNF = trim(substring(ControleV3, 203, 2)),",
				"          SerieNF = trim(substring(ControleV3, 823, 3))) ~> ColunasDerivadas",
				"ColunasDerivadas sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'parquet',",
				"     filePattern:($pNomeArq),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     mapColumn(",
				"          Cnpj,",
				"          IE,",
				"          RazaoSocial,",
				"          Endereco,",
				"          CEP,",
				"          Bairro,",
				"          Municipio,",
				"          UF,",
				"          Responsavel,",
				"          Cargo,",
				"          Telefone,",
				"          Email,",
				"          QtdeRegMestre,",
				"          QtdeNFcanceladas,",
				"          DataEmissaoPriDoc,",
				"          DataEmissaoUltDoc,",
				"          NumeroPriDoc,",
				"          NumeroUltDoc,",
				"          ValorTotal,",
				"          BCIcms,",
				"          ICMS,",
				"          OpIsentas,",
				"          ValoresNaoBC,",
				"          NomeArqMestre,",
				"          StatusRetificacao,",
				"          CodAutenticacao,",
				"          QtdeRegItem,",
				"          QtdeItensCancelados,",
				"          DataEmissaoPriDocItens,",
				"          DataEmissaoUltDocItens,",
				"          NumeroPriDocItens,",
				"          NumeroUltDocItens,",
				"          Total,",
				"          Descontos,",
				"          Acrescimos,",
				"          BCIcmsTotal,",
				"          ICMSTotal,",
				"          OpIsentasTotal,",
				"          ValoresNaoBCTotal,",
				"          NomeArqItem,",
				"          StatusRetificacaoItem,",
				"          CodAutenticacaoItem,",
				"          QtdeCadastroDest,",
				"          NomeArqCadastro,",
				"          StatusRetificacaoCadastro,",
				"          CodAutenticacaoCadastro,",
				"          VersaoValidador,",
				"          ChaveReciboEntrega,",
				"          QtdeAdvertencias,",
				"          Referencia,",
				"          Modelo,",
				"          Serie,",
				"          Volume,",
				"          SituacaoVersao,",
				"          NomeArqCompactado,",
				"          QtdeTipoA,",
				"          ValorTotalTipoA,",
				"          BCIcmsA,",
				"          ICMSA,",
				"          IsentasNTA,",
				"          OutrosValoresA,",
				"          QtdeTipoB,",
				"          ValorTotalB,",
				"          BCIcmsB,",
				"          ICMSB,",
				"          IsentasNTB,",
				"          OutrosValoresB,",
				"          QtdeTipoC,",
				"          ValorTotalC,",
				"          BCIcmsC,",
				"          ICMSC,",
				"          IsentasNTC,",
				"          OutrosValoresC,",
				"          QtdeTipoD,",
				"          ValorTotalD,",
				"          BCIcmsD,",
				"          ICMSD,",
				"          IsentasNTD,",
				"          OutrosValoresD,",
				"          ChaveControle,",
				"          Brancos,",
				"          CodAutenticacaoRegistro,",
				"          AnoEmissaoPriDoc,",
				"          MesEmissaoPriDoc,",
				"          DiaEmissaoPriDoc,",
				"          UFNF,",
				"          SerieNF",
				"     ),",
				"     partitionBy('key',",
				"          0,",
				"          SerieNF,",
				"          UFNF,",
				"          AnoEmissaoPriDoc,",
				"          MesEmissaoPriDoc,",
				"          DiaEmissaoPriDoc",
				"     )) ~> SaidaParquetArqControle"
			]
		}
	}
}